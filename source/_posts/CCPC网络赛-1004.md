---
title: CCPC网络赛 1004
date: 2019-08-28 09:06:05
tags: 题解
---

老年退役选手去打了一下下网络赛，哑巴里很菜呀XD。BPM在敲1003的时候我和洛洛想1004，但是完全想不到，结果BPM写完之后一听题意就秒掉了呢qwq可惜这家伙差几秒钟没能把AC的代码交上去。
感觉触及到了我的思路盲区，所以记录一下。

### 题意
给一个有向图，重边自环都可能有，每次询问问这个图里面权值和第$k$小的路径权值和是多少。
点，边，询问数量$5e4$，$k$最大$5e4$。

### 题解
k的范围很容易想到递推，即现在已知第k小的路径，求第k+1小的路径。
考虑从只有一条边的路径开始，每次添加一条边，将路径往下扩展。将从一个点出发的边按权值从小到大排序，那么对于这个点结束的路径，添加小的边会得到更小的路径。
我们记录最后一条边是倒数第二个点出发的第几大边。将当前的所有路径丢进一个优先队列，每次取出最小路径的时候，加两条新的路径进去。如图：
![image.png](https://i.loli.net/2019/08/27/utHrDTAzgyUq69B.png)
在将最后一条边为第k大的路径取出来的时候，我们加进去两条新的路径，一条是去掉k加上k+1，另外是在k后面加上末尾点出发的最小边，即第0大的边。
每次队列中拿出一个放入两个，最多有2m个路径在里面。
真是巧妙呢XD。

